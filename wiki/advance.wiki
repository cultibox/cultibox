#summary Utilisation avancée

= Sommaire =
<wiki:toc max_depth="4" />

= Introduction =

Cette page ne concerne que les utilisateurs experts.

= Calendriers d'engrais =
== Introduction ==

Les fabricants d'engrais peuvent nous soumettre les calendriers de leurs engrais pour qu'ils soient disponible dans le calendrier de l'utilisateur.
Nous nous réservons le droit d'ajouter ou de supprimer les calendriers.

== Format du calendrier ==
Le calendrier est au format XML. Il doit être écrit selon le format d'un flux de syndication ATOM.

=== Informations obligatoires ===
Il est nécessaire de spécifier la balise d'en-tête XML, et le nœud racine contenant l'URL du namespace d'Atom. Pour Atom, ce nœud s'appelle feed et le namespace est http://www.w3.org/2005/Atom.

Construction du fichier:

{{{
<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
</feed>
}}}

==== Date de mise à jour ====
La date de mise à jour du flux ATOM doit être spécifiée. Elle doit être écrite au format [http://www.faqs.org/rfcs/rfc3339.html  RCF 3339 / ISO 8601].

Exemple de date de mise à jour:

{{{
<updated>2008-05-29T13:14:57+02:00</updated>
}}}

==== Identifiant unique ====
Le flux ATOM doit contenir un identifiant unique. Le plus simple est d'indiquer directement le nom du site web du fabricant.

Exemple d'identifiant:

{{{
<id>http://www.cultibox.fr/</id>
}}}

==== Titre ====
Le flux ATOM doit contenir le titre et le sous titre. Pour notre calendrier:
  * Le titre est le fabricant.
  * Le sous titre est le nom du produit ou de la gamme.

Exemple de titre:

{{{
<title>Engrais Top</title>
<subtitle>Engrais numéro 1</subtitle>
}}}

==== Auteur ====
Le flux ATOM doit contenir un auteur. Pour définir un auteur, il faut utiliser la balise <author>.
Exemple d'auteur:

{{{
<author>
    <name>Cultibox</name>
    <uri>http://www.cultibox.fr/</uri>
    <email>info@cultibox.fr</email>
</author>
}}}

==== Catégorie ====
Cette information est obligatoire. Elle nous permet d'identifier quel type d'engrais est contenu dans ce fichier. Elle permet aussi de séparer le calendrier lunaire des autres calendriers.

la catégorie doit être engrais. 

Exemple de catégorie:

{{{
<category term = "engrais" label = "engrais">
    [...]
</category>
}}}

Si vous voulez que votre engrais soit reconnu et affiché dans la gestion du calendrier il faudra rajouter à cela plusieurs champs:
 * substrat: permettant de définir le type de substrat (Terre, Hydro, Aero, Coco)
 * periode: la période adaptée à l'utilisation de l'engrais (croissance, floraison...). C'est le nom qui est affiché dans le selecteur d'engrais.
 * marque: la marque de l'engrais

Voici un exemple complet:

{{{
<category term = "engrais" label = "engrais">
   <substrat>Terre</substrat>
   <periode>croissance</periode>
   <marque>Biocanna</marque>
</category>
}}}

==== Lien ====
Un lien vers lui même:

Exemple:

{{{
<link rel="self" href="www.cultibox.fr/flux.xml" />
}}}

=== Informations non obligatoire ===
De plus, le fabriquant à la possibilité de définir les rubriques suivantes:
  * Icon
  * Logo
  * Droits
Ces informations ne sont pour l'instant pas utilisées.

==== Icon ====
Le fabricant peut définir une icône.
Exemple:

{{{
<icon>http://wwww.com/images/icon.png</icon>
}}}
==== Logo ====
Le fabricant peut définir un logo.
Exemple:

{{{
<logo>http://wwww.com/images/icon.png</logo>
}}}
==== Droits, copyrights ====
Cette balise est une construction « texte ».

Exemple:

{{{
<rights type = "text">
    © Cultibox, 2013
</rights>
}}}

=== Les entrées ===
Chaque entrée est contenu dans une balise <entry>. Les entrées correspondent à des événement du calendrier.

==== Informations Obligatoires ====
===== Titre =====
Chaque entrée doit contenir le titre. C'est le titre qui sera donné à l’événement du calendrier.

Exemple de titre:

{{{
<title>Phase croissance</title>
}}}

===== Date de mise à jour =====
Chaque entrée doit avoir une date de mise à jour. Elle doit être écrite au format [http://www.faqs.org/rfcs/rfc3339.html  RCF 3339 / ISO 8601].

Exemple de date de mise à jour:

{{{
<updated>2008-05-29T13:14:57+02:00</updated>
}}}


===== Identifiant unique =====
Chaque entrée doit contenir un identifiant unique.

Exemple d'identifiant:

{{{
<id>http://www.cultibox.fr/id1</id>
}}}


==== Informations facultatives ====
===== Auteur =====
Le flux ATOM doit contenir un auteur. Comme un auteur est définit dans les balises feed, vous n'êtes pas obligé de redéfinir un auteur.
Exemple d'auteur:

{{{
<author>
    <name>Cultibox</name>
    <uri>http://www.cultibox.fr/</uri>
    <email>info@cultibox.fr</email>
</author>
}}}

===== résumé =====
Exemple:

{{{
<summary>Phase de croissance</summary>
}}}

==== Catégorie ====
Cette information permet d'identifier quel type d'engrais est contenu dans ce fichier.
Les catégories disponible sont:
|| *term* || *label* ||
|| bouture || Bouturage ||
|| vegetation || Vegetation ||
|| prefloraison  || prefloraison  ||
|| floraison || floraison ||
|| recolte || recolte ||

Exemple de catégorie:

{{{
<category term = "bouture" label = "Bouturage" />
}}}

Non utilisé.

===== contenu =====
C'est cette balise qui contient le texte de l’événement.

Exemple:

{{{
<content type = "text">
   N'oubliez pas une dose de XX!
</content>
}}}

===== durée =====
Cette balise permet de définir la durée de l’événement. La durée est inscrite en jour.

Exemple (3 jours):

{{{
<duration>3</duration>
}}}

===== Début de cet événement =====
Cette balise permet de définir la date de début de l’événement. La durée est inscrite en jour.

Exemple (Au bout de 18 jours):

{{{
<start>2008-05-29T13:14:57+02:00</start>
}}}

===== Nutriment =====
Cette balise permet de définir le nom du nutriment et le dosage. Elle peut contenir deux champs : name et dosage.

Exemple:

{{{
<nutriment>
  <name>Engrais 1</name>
  <dosage>3ml/l</dosage>
</nutriment>
}}}

===== Couleur =====
Cette balise permet de définir la couleur qui sera utilisée lors de l'affichage de l’événement dans le calendrier du logiciel. La couleur peut être définie aussi bien par son nom anglais (exemple: red, yellow...) que par son code hexadécimal (exemple: #ffffff, #A485E9 ...)

Exemple:

{{{
<color>red</color>
}}}

===== Icône =====
Cette balise permet de définir une icône qui sera utilisée lors de l'affichage de l’événement dans le calendrier du logiciel. L'icône peut être définie de deux façons: en ne donnant que le nom de l'icône et en plaçant cette icône dans le répertoire *htdocs/cultibox/main/modules/img/* ou alors en fournissant une adresse complète. L'affichage est optimisé pour une icône de 15 pixels sur 15 pixels.
Exemple:

{{{
<icon>moon.png</icon>
}}}

ou alors:

{{{
<icon>http://voici.une.url.com/icone.png</icon>
}}}

== Exemple de fichier ==

{{{
<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
   <updated>2013-11-03T10:37:57+02:00</updated>
   <id>http://www.cultibox.fr/</id>
   <title>House and Garden Standard Terre</title>
   <subtitle></subtitle>
   <author>
      <name>Cultibox</name>
      <uri>http://www.cultibox.fr/</uri>
      <email>info@cultibox.fr</email>
   </author>
   <category term = "engrais" label = "engrais">
    <substrat>Terre</substrat>
    <periode>Standard</periode>
    <marque>House and Garden</marque>
   </category>
   <link rel="self" href="www.cultibox.fr/House and Garden_Terre.xml" />
   <icon></icon>
   <logo></logo>
   <rights type = "text">
    © Cultibox, 2013
   </rights>
}}}
{{{
    <entry>
      <title>S1 Croissance</title>
      <summary>S1 Croissance</summary>
      <updated>2008-05-29T13:14:57+02:00</updated>
      <id>http://www.cultibox.fr/id1</id>
      <category term = "vegetation" label = "Vegetation" />
      <content type = "text"></content>
      <ec>1,2</ec>
      <duration>7</duration>
      <start>0</start>
      <facultative>0</facultative>
      <nutriment>
        <name>Roots Excelurator</name>
        <dosage>0,3 ml/l</dosage>
      </nutriment>
      <nutriment>
        <name>Terre A B</name>
        <dosage>1,5 ml/l</dosage>
      </nutriment>
      <nutriment>
        <name>Amino Treatment</name>
        <dosage>0,25 ml/l</dosage>
      </nutriment>
      <nutriment>
        <name>Algen extract</name>
        <dosage>1 ml/l</dosage>
      </nutriment>
      <color>#98FB98</color>
      <icon>House_and_Garden.png</icon>
   </entry>
}}}
{{{
    <entry>
      <title>S2 Croissance</title>
      <summary>S2 Croissance</summary>
      <updated>2008-05-29T13:14:57+02:00</updated>
      <id>http://www.cultibox.fr/id1</id>
      <category term = "vegetation" label = "Vegetation" />
      <content type = "text"></content>
      <ec>1,2</ec>
      <duration>7</duration>
      <start>7</start>
      <facultative>0</facultative>
      <nutriment>
        <name>Roots Excelurator</name>
        <dosage>0,3 ml/l</dosage>
      </nutriment>
      <nutriment>
        <name>Terre A B</name>
        <dosage>1,5 ml/l</dosage>
      </nutriment>
      <nutriment>
        <name>Amino Treatment</name>
        <dosage>0,35 ml/l</dosage>
      </nutriment>
      <nutriment>
        <name>Algen extract</name>
        <dosage>1 ml/l</dosage>
      </nutriment>
      <color>#9ACD32</color>
      <icon>House_and_Garden.png</icon>
   </entry>
</feed>
}}}

= Ajouter un test Sélénium =
== Introduction ==
Sélénium est un environnement de test qui permet de valider notre logiciel. Ce chapitre ne concerne que les personnes qui souhaitent participer au développement et à l'amélioration du logiciel.

== Sélénium IDE ==
Avant toute chose, il vous faut Mozilla Firefox. Ensuite télécharger le plug-in sélénium pour Firefox:
/http://release.seleniumhq.org/selenium-ide/2.0.0/selenium-ide-2.0.0.xpi

Autoriser l'installation puis suivez les instructions.

== Enregistrer un test ==
Lancer Firefox.
Dans le menu Firefox puis Développement  Web, cliquer sur Selenium IDE.
Une interface s'affiche.

Cliquer sur le rond rouge pour démarrer ou arrêter l’enregistrement de votre test.

Ensuite, il faut enregistrer votre suite de test. Cliquer sur fichier, enregistrer la suite de test sous (et non pas sauver le test sous).
Vous devez enregistrer chacun des fichier pour chaque test puis enregistrer le fichier qui contient la suite de test.

== Archiver le test ==
Pour pouvoir lancer le test, il est nécessaire d'archiver le test dans SVN.
Il faut ajouter un dossier dans le dossier trunk/01_software/03_test/01_selenium avec votre test, puis coller les fichiers Selenium à l'intérieur. 
N'oubliez pas de commiter.

== Créer le test dans Jenkins ==
Dans Jenkins, dans la vue test, cliquer sur "nouveau job". Puis cliquer sur "Copier un job existant". Entrer test_selenium dans "Copier à partir de". Le nom de votre job doit être le même que le nom du dossier. 
Dans la partie "Exécuter un script shell" de la section build, changer les chemins pour qu'ils pointent vers votre test.

= Changer le numéro de la prise 3500W =
 * Débrancher la Cultibox
 * Brancher la prise 3500W
 * Appuyer sur le petit bouton en façade pendant au moins 10s jusqu’à ce que la LED clignote. 
 * Relâcher le bouton puis appuyer une fois sur le bouton.
 * La prise clignote deux fois
 * Ouvrir le fichier pluga
 * changer la première ligne. Mettre 001.
 * Mettre le numéro pour la prise sur la deuxième ligne (typiquement 004)
 * Brancher la Cultibox
 * Aller dans le menu Param --> Émetteur --> reg prise
 * Clique gauche pour éteindre la prise
 * appuyer un coup sur le petit bouton de la prise. Elle doit clignoter
 * Rapidement, appuyer sur le bouton droite de la Cultibox.
 * La prise doit clignoter deux fois
 * Si ça marche pas, refaire les étapes 10 à 13