<script type="text/javascript">
   function getTolerance(i,j) {
      var divTolerance = document.getElementById('tolerance'+j);
      var divToleranceLabel = document.getElementById('tolerance_label'+j);
      var firstdivToleranceLabel = document.getElementById('first_tolerance_label'+j);
      var firstTolerance = document.getElementById('first_tolerance'+j);
      var pDegree = document.getElementById('degree'+j);
      var pPourcent = document.getElementById('pourcent'+j);


      //FIXME: change dynamically plug_tolerance value
      oFormObject = document.forms['plugForm'];
      oFormElement = oFormObject.elements['plug_tolerance'+j];
     
      switch(i) {
         case 0 : divTolerance.style.display = 'none'; divToleranceLabel.style.display = 'none'; pDegree.style.display = 'none'; pPourcent.style.display = 'none'; firstdivToleranceLabel.style.display = 'none'; firstTolerance.style.display = 'none'; break;
         case 1 : divTolerance.style.display = 'none'; divToleranceLabel.style.display = 'none'; pDegree.style.display = 'none'; pPourcent.style.display = 'none'; firstdivToleranceLabel.style.display = 'none'; firstTolerance.style.display = 'none'; break;
         case 2 : divTolerance.style.display = ''; divToleranceLabel.style.display = ''; pDegree.style.display = ''; pPourcent.style.display = 'none'; firstdivToleranceLabel.style.display = 'none'; firstTolerance.style.display = 'none'; break;
         case 3 : divTolerance.style.display = ''; divToleranceLabel.style.display = ''; pDegree.style.display = ''; pPourcent.style.display = 'none'; firstdivToleranceLabel.style.display = 'none'; firstTolerance.style.display = 'none'; break;
         case 4 : divTolerance.style.display = ''; divToleranceLabel.style.display = ''; pDegree.style.display = 'none'; pPourcent.style.display = ''; firstdivToleranceLabel.style.display = 'none'; firstTolerance.style.display = 'none'; break;
         case 5 : divTolerance.style.display = ''; divToleranceLabel.style.display = ''; pDegree.style.display = 'none'; pPourcent.style.display = ''; firstdivToleranceLabel.style.display = 'none'; firstTolerance.style.display = 'none'; break;         
         default: divTolerance.style.display = 'none'; divToleranceLabel.style.display = 'none'; pDegree.style.display = 'none'; pPourcent.style.display = 'none'; firstdivToleranceLabel.style.display = 'none'; firstTolerance.style.display = 'none'; break;
      }
   }
</script>

<?php if((isset($pop_up))&&("$pop_up"!="False")&&(isset($pop_up_message))&&(!empty($pop_up_message))) { ?>
   <SCRIPT LANGUAGE="JavaScript">
      alert('<?php echo "$pop_up_message"; ?>');
   </SCRIPT>
<?php } else if((isset($pop_up))&&("$pop_up"!="False")&&(isset($pop_up_error_message))&&(!empty($pop_up_error_message))) { ?>
   <SCRIPT LANGUAGE="JavaScript">
      alert('<?php echo "$pop_up_error_message"; ?>');
   </SCRIPT>
<?php } ?>

<?php if((isset($info))&&(!empty($info))) { ?>
<div id="info">
   <ul>
      <?php echo $info; ?>
   </ul>
</div>
<?php } ?>

<?php if((isset($error))&&(!empty($error))) { ?>
<div id="error">
   <ul>
      <?php echo $error; ?>
   </ul>
</div>
<br />
<?php } ?>

<br />
<form action="<?php echo($_SERVER['PHP_SELF']); ?>" method="post" name="plugForm" id="plugForm">
   <?php for($i=1;$i<=$nb_plugs;$i++) { ?>
   <table width="100%">
      <tr>
         <td width="20%">
            <p class="title_conf"><?php echo __('PLUG')." $i:"; ?></p>
         </td>
      </tr>
      <tr>
         <td></td>
         <td>
              <?php echo __('NAME_PLUG'); ?>
         </td>
         <td>
            <input type="text" size="20" maxlength="20" name="plug_name<?php echo $i; ?>" value="<?php echo $plug_name{$i}; ?>">
         </td>
      </tr>
      <tr>
         <td></td>
         <td width="25%">
            <?php echo __('TYPE_PLUG'); ?>
         </td>
         <td>
            <select name="plug_type<?php echo $i; ?>" onChange="getTolerance(this.selectedIndex,<?php echo $i; ?>);" onLoad="getTolerance(this.selectedIndex,<?php echo $i; ?>);">
               <option <?php if(strcmp($plug_type{$i},"unknown")==0) { echo 'selected';} ?> value="unknown"><?php echo __('PLUG_UNKNOWN'); ?></option>
               <option <?php if(strcmp($plug_type{$i},"lamp")==0) { echo "selected";} ?> value="lamp"><?php echo __('PLUG_LAMP'); ?></option>
               <option <?php if(strcmp($plug_type{$i},"ventilator")==0) { echo 'selected';} ?> value="ventilator"><?php echo __('PLUG_VENTILATOR'); ?></option>
               <option <?php if(strcmp($plug_type{$i},"heating")==0) { echo 'selected';} ?> value="heating"><?php echo __('PLUG_HEATING'); ?></option>
               <option <?php if(strcmp($plug_type{$i},"humidifier")==0) { echo 'selected';} ?> value="humidifier"><?php echo __('PLUG_HUMIDIFIER'); ?></option>
               <option <?php if(strcmp($plug_type{$i},"dehumidifier")==0) { echo 'selected';} ?> value="dehumidifier"><?php echo __('PLUG_DEHUMIDIFIER'); ?></option>
            </select>
         </td>
      </tr>
      <tr>
         <td></td>
         <td>
            <div id="tolerance_label<?php echo $i; ?>" style="display:none">
               <?php echo __('TOLERANCE_PLUG'); ?>
            </div>
            <?php if((strcmp($plug_type{$i},"ventilator")==0)||(strcmp($plug_type{$i},"heating")==0)||(strcmp($plug_type{$i},"humidifier")==0)||(strcmp($plug_type{$i},"dehumidifier")==0)) { ?>
            <div id="first_tolerance_label<?php echo $i; ?>">
               <?php echo __('TOLERANCE_PLUG'); ?>
            </div>
            <?php } ?>
         </td>
         <td>
            <div id="tolerance<?php echo $i; ?>" style="display:none">
               <input type="text" id="plug_tolerance<?php echo $i; ?>" size="4" style="width: 10%;" maxlength="4" name="plug_tolerance<?php echo $i; ?>" value="<?php echo $plug_tolerance{$i}; ?>" /><label id="pourcent<?php echo $i; ?>" style="display:none"> %</label><label id="degree<?php echo $i; ?>" style="display:none"> °C</label>
            </div>
            <?php if((strcmp($plug_type{$i},"ventilator")==0)||(strcmp($plug_type{$i},"heating")==0)||(strcmp($plug_type{$i},"humidifier")==0)||(strcmp($plug_type{$i},"dehumidifier")==0)) { ?>
            <div id="first_tolerance<?php echo $i; ?>">
               <input type="text" size="4" style="width: 10%;" maxlength="4" name="plug_tolerance<?php echo $i; ?>" value="<?php echo $plug_tolerance{$i}; ?>"><?php if((strcmp($plug_type{$i},"humidifier")==0)||(strcmp($plug_type{$i},"dehumidifier")==0)) { ?><label id="pourcent<?php echo $i; ?>"> %</label><?php } else { ?><label id="degree<?php echo $i; ?>"> °C</label><?php } ?>
            </div>
            <?php } ?>
         </td>
      </tr>
      <tr>
         <td></td>
         <td>
            <?php echo __('POWER_PLUG'); ?><img src="main/libs/img/infos.png" alt="" class="info-bulle-css" title="<?php echo __('TOOLTIP_POWER'); ?>" />
         </td>
         <td>
            <input type="text" size="3" maxlength="3" name="plug_power<?php echo $i; ?>" value="<?php echo $plug_power{$i}; ?>">
         </td>
      </tr>

      <tr>
         <td></td>
         <td>
            <?php echo __('ID_PLUG'); ?>
         </td>
         <td>
            <input type="text" size="3" maxlength="3" name="plug_id<?php echo $i; ?>" value="<?php echo $plug_id{$i}; ?>" <?php if($i<=3) echo "disabled"; ?>>
         </td>
      </tr>
   </table>
<?php if((isset($error_plug[$i]))&&(!empty($error_plug[$i]))) { ?>
<div id="error">
   <ul>
      <?php echo $error_plug[$i]; ?>
   </ul>
</div>
<?php } else if((isset($info_plug[$i]))&&(!empty($info_plug[$i]))) { ?>
<div id="info">
   <ul>
      <?php echo $info_plug[$i]; ?>
   </ul>
</div>
<?php } ?>


<br />
<hr />
   <?php } ?>
<br /><br />
   <table width="100%">
      <tr>
         <td width="20%"></td>
         <td>
            <INPUT type="submit" name="reset" value="<?php echo __('RESET_PLUG_ID'); ?>">
         </td>
         <td>
            <INPUT type="submit" name="reccord" value="<?php echo __('VALIDATION_PLUG_CONF'); ?>">
         </td>
      </tr>
   </table>
</form>
