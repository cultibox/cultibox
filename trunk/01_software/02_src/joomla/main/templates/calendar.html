<?php if((isset($pop_up))&&("$pop_up"!="False")&&(isset($pop_up_message))&&(!empty($pop_up_message))) { ?>
    <div class="pop_up_message" style="display:none">
            <?php echo str_replace("\\n\\n","<br /><br />","$pop_up_message"); ?>
    </div>
<?php } else if((isset($pop_up))&&("$pop_up"!="False")&&(isset($pop_up_error_message))&&(!empty($pop_up_error_message))) { ?>
       <div class="pop_up_error" style="display:none">
            <?php echo str_replace("\\n\\n","<br /><br />","$pop_up_error_message"); ?>
       </div>
<?php } ?>

<?php if((((isset($main_info))&&(!empty($main_info))&&(count($main_info)>0)))||((isset($main_error))&&(!empty($main_error))&&(count($main_error)>0))) { ?>
<div class="message" style="display:none" title="<?php echo __('MESSAGE_BOX'); ?>">
        <br />
        <?php if((isset($main_info))&&(!empty($main_info))&&(count($main_info)>0)) { ?>
<img src="main/libs/img/informations.png" alt="" /><label class="info_title"><?php echo __('INFORMATION'); ?>:</label>
<div class="info">
<ul>
        <?php foreach($main_info as $inf) { 
            echo "<li>".$inf."</li>";            
        } ?>
</ul>
<br />
</div>
    <?php } ?>
    <?php if((isset($main_error))&&(!empty($main_error))&&(count($main_error)>0)) { ?>
<img src="main/libs/img/warning.png" alt="" /><label class="error_title"><?php echo __('WARNING'); ?>:</label>
<div class="error">
<ul>
        <?php foreach($main_error as $err) { 
            echo "<li>".$err."</li>";            
        } ?>
</ul>
</div>
    <?php } ?>
</div>
<?php } ?>
<br />

<?php switch($_SESSION['LANG']) {
        case 'fr_FR': 
                echo '<script type="text/javascript" src="main/libs/js/jquery.ui.datepicker-fr.js"></script>'; 
                break;
        case 'it_IT':
                echo '<script type="text/javascript" src="main/libs/js/jquery.ui.datepicker-it.js"></script>';
                break;
        case 'de_DE':
                echo '<script type="text/javascript" src="main/libs/js/jquery.ui.datepicker-de.js"></script>';
                break;
        case 'es_ES':
                echo '<script type="text/javascript" src="main/libs/js/jquery.ui.datepicker-es.js"></script>';
                break;
        }
?>


<script>
$(function() {
   $("#calendar_startdate").datepicker({ 
dateFormat: "yy-mm-dd",
showButtonPanel: true,
showOn: "both",
buttonImage: "../../main/libs/img/datepicker.png",
buttonImageOnly: 'true',
<?php echo "buttonText: '".__('TIMEPICKER_BUTTON_TEXT_LOG')."',"; ?>
}).val();


$("#datepicker_calendar").datepicker({ 
dateFormat: "yy-mm",
yearRange: "-20:+0",
changeMonth: true, 
changeYear: true,
showOn: "both",
showButtonPanel: true,
buttonImage: "../../main/libs/img/calendar_icon.png",
buttonImageOnly: 'true',
<?php echo "buttonText: '".__('TIMEPICKER_BUTTON_TEXT_LOG')."'"; ?>,
beforeShow: function() { 
        $('#hideday').html('.ui-datepicker-calendar{display:none;}'); 
        $('#hidetoday').html('.ui-datepicker-current{display:none;}');
},
onClose: function(dateText, inst){
        setTimeout(function(){$('#hideday').html('');},300);
        setTimeout(function(){$('#hidetoday').html('');},300);
        var month = $("#ui-datepicker-div .ui-datepicker-month :selected").val();
        var year = $("#ui-datepicker-div .ui-datepicker-year :selected").val();
        $("#calendar").fullCalendar( 'gotoDate', year , month );
}
}).val();
});
</script>

<?php if((isset($sd_card))&&(!empty($sd_card))) { ?>
<script>
sd_card = <?php echo json_encode($sd_card) ?>;
</script>
<?php } else { ?>
<script>
sd_card = "";
</script>
<?php } ?>
<script>
product_array = <?php echo json_encode($product) ?>;
</script>

<style id='hideday'></style>
<style id='hidetoday'></style>

<script>


    $(document).ready(function() {
        $('#calendar').fullCalendar({
            editable: true,
            dragable: true,
            selectable: true,
            unselectable: true,
            theme: true,
            monthNames:["<?php echo __('MONTH01'); ?>","<?php echo __('MONTH02'); ?>","<?php echo __('MONTH03'); ?>","<?php echo __('MONTH04'); ?>","<?php echo __('MONTH05'); ?>","<?php echo __('MONTH06'); ?>","<?php echo __('MONTH07'); ?>","<?php echo __('MONTH08'); ?>","<?php echo __('MONTH09'); ?>","<?php echo __('MONTH10'); ?>","<?php echo __('MONTH11'); ?>","<?php echo __('MONTH12'); ?>"],
            monthNamesShort:["<?php echo __('M01'); ?>","<?php echo __('M02'); ?>","<?php echo __('M03'); ?>","<?php echo __('M04'); ?>","<?php echo __('M05'); ?>","<?php echo __('M06'); ?>","<?php echo __('M07'); ?>","<?php echo __('M08'); ?>","<?php echo __('M09'); ?>","<?php echo __('M10'); ?>","<?php echo __('M11'); ?>","<?php echo __('M12'); ?>"],
            dayNames: ["<?php echo __('DAY07'); ?>","<?php echo __('DAY01'); ?>","<?php echo __('DAY02'); ?>","<?php echo __('DAY03'); ?>","<?php echo __('DAY04'); ?>","<?php echo __('DAY05'); ?>","<?php echo __('DAY06'); ?>"],
            dayNamesShort: ["<?php echo __('D07'); ?>","<?php echo __('D01'); ?>","<?php echo __('D02'); ?>","<?php echo __('D03'); ?>","<?php echo __('D04'); ?>","<?php echo __('D05'); ?>","<?php echo __('D06'); ?>"],
            buttonText: { today: "<?php echo __('TODAY'); ?>"}, 
            select: function(start, end, allDay) {
                $("#edit_start_date").text($.fullCalendar.formatDate(start, "yyyy-MM-dd"));
                     if(end) {
                        $("#edit_stop_date").text($.fullCalendar.formatDate(end, "yyyy-MM-dd"));
                     }else {
                        $("#edit_stop_date").text($.fullCalendar.formatDate(start, "yyyy-MM-dd"));
                }

                $("#select_remark").val("");

                $("#select_color").val("#000000"); 
                $('#colour').css({'background-color' : '#000000'});


                $("#dialog_create").dialog({
                        resizable: true,
                        width: 800,
                        buttons: {
                            "<?php echo __('CREATE_DIALOG_CALENDAR','highchart'); ?>": function() { 
                                        $( this ).dialog( "close" ); 
                                        <?php if((isset($sd_card))&&(!empty($sd_card))) { ?>
                                            $.blockUI({ message: ''});
                                        <?php } ?>
                
                                        new_start=$.fullCalendar.formatDate( start, "yyyy-MM-dd HH:mm:ss");
                                        new_end=$.fullCalendar.formatDate( end, "yyyy-MM-dd HH:mm:ss");        

                                        var length = $('#select_title').children('option').length;
                                        if(($("#select_title").prop('selectedIndex')+1)==length) {
                                            if($("#other_field_title").val()!= "") {
                                                var title=$("#other_field_title").val();
                                            } else {
                                                var title=$('#select_title option:selected').val(); 
                                            }
                                        } else {
                                            var title=$('#select_title option:selected').val(); 
                                        }
                                        var description=$('#select_remark').val();  
                                        var color=$('#select_color').val();
                                        if(!description) {
                                            description="";
                                        }
                                        if (title) {
                                            $('#calendar').fullCalendar('renderEvent', {
                                            title: title,
                                            start: new_start,
                                            end: new_end,
                                            description: description,
                                            color: color,
                                            external: external
                                        });

                                        if(!color) {
                                            color="#000000";
                                        }

                                        $.ajax({
                                            type: "POST",
                                            url: "http://localhost:6891/cultibox/main/modules/json-events/json-add-events.php",
                                            data: 'title='+encodeURIComponent(title)+'&start='+new_start+'&end='+new_end+'&desc='+encodeURIComponent(description)+'&color='+color+'&card=<?php echo $sd_card; ?>'
            
                                            <?php if((isset($sd_card))&&(!empty($sd_card))) { ?>
                                                ,complete: function() { $.unblockUI(); }
                                            <?php } ?> 
                                        }).done(function (data) {
                                            if(data==1) {
                                                $.ajax({
                                                    type: "POST",
                                                    url: "http://localhost:6891/cultibox/main/modules/external/get_title_calendar_list.php",
                                                    data: 'lang='+encodeURIComponent("<?php echo $lang; ?>")
                                                }).done(function (data) {
                                                    if(data!="") {
                                                        var myTitle = data.split(',,,'); 
                                                        $('#select_title').children().remove();
                                                        $.each( myTitle, function( key, value ) {
                                                            $('#select_title').append(new Option(value, value, true, true)); 
                                                        });
                                                        $("#select_title").prop('selectedIndex', 0);  
                                                        $("#other_title_div").css("display","none");
                                                    }
                                                });       
                                            }
                                        });

                                        }
                                        $('#calendar').fullCalendar('unselect');
                                        $('#calendar').fullCalendar('refetchEvents');
                                        $('#calendar').fullCalendar('rerenderEvents');
                                        $("#select_remark").text("");
                                        $("#select_remark").val("");
                                        $("#other_field_title").text("");
                                        $("#other_field_title").val("");
                                        $("#select_title").prop('selectedIndex', 0);  
                                         
                                        delete description;
                                        delete event;
                                        return false;
                        },
                    "<?php echo __('CANCEL_DIALOG_CALENDAR','highchart'); ?>": function() { 
                                        $( this ).dialog( "close" ); 
                                        $("#select_remark").text("");
                                        $("#select_remark").val("");
                                        $("#other_field_title").text("");
                                        $("#other_field_title").val("");
                                        $("#select_title").prop('selectedIndex', 0);  
                                        delete description;
                                        delete event;
                                        return false;}
                        }
                    });
            },
            events: "http://localhost:6891/cultibox/main/modules/json-events/json-events.php",
            
            eventDrop: function(event, delta) {
                if(event.external) {
                    $('#calendar').fullCalendar( 'refetchEvents' );
                    $('#calendar').fullCalendar( 'rerenderEvents' );
                    return false;
                }

                new_start=$.fullCalendar.formatDate(event.start, "yyyy-MM-dd HH:mm:ss");
                if(!event.end) {
                    event.end=event.start
                }

                new_end=$.fullCalendar.formatDate(event.end, "yyyy-MM-dd HH:mm:ss");

                <?php if((isset($sd_card))&&(!empty($sd_card))) { ?>
                    $.blockUI({ message: ''}); 
                <?php } ?> 
                $.ajax({
                      type: "POST",
                      url: "http://localhost:6891/cultibox/main/modules/json-events/json-update-events.php",
                      data: 'title='+encodeURIComponent(event.title)+'&start='+ new_start +'&end='+ new_end +'&id='+event.id+'&color='+event.color+'&card=<?php echo $sd_card; ?>'
                         <?php if((isset($sd_card))&&(!empty($sd_card))) { ?>
                            ,complete: function() { $.unblockUI(); }
                         <?php } ?> 
                });
            },
            eventResize: function(event, dayDelta, minuteDelta) { 
                if(event.external) {
                    $('#calendar').fullCalendar( 'refetchEvents' );
                    $('#calendar').fullCalendar( 'rerenderEvents' );
                    return false;
                }
                new_start=$.fullCalendar.formatDate(event.start, "yyyy-MM-dd HH:mm:ss");
                if(!event.end) {
                    event.end=event.start
                }

                new_end=$.fullCalendar.formatDate(event.end, "yyyy-MM-dd HH:mm:ss");

                <?php if((isset($sd_card))&&(!empty($sd_card))) { ?>
                    $.blockUI({ message: ''}); 
                <?php } ?>
                $.ajax({
                      type: "POST",
                      url: "http://localhost:6891/cultibox/main/modules/json-events/json-update-events.php",
                      data: 'title='+encodeURIComponent(event.title)+'&start='+ new_start +'&end='+ new_end +'&id='+event.id+'&color='+event.color+'&card=<?php echo $sd_card; ?>'
                      <?php if((isset($sd_card))&&(!empty($sd_card))) { ?>
                          ,complete: function() { $.unblockUI(); }
                      <?php } ?>
                });
            },
            eventClick: function(event, element) {
                     $("#title").text(event.title);
                     $("#start_date").text($.fullCalendar.formatDate(event.start, "yyyy-MM-dd"));
                     if(event.end) {
                        $("#stop_date").text($.fullCalendar.formatDate(event.end, "yyyy-MM-dd"));
                     }else {
                        $("#stop_date").text($.fullCalendar.formatDate(event.start, "yyyy-MM-dd"));
                     }
                     if(event.description) {
                        $("#remark").val(event.description);
                     } else {
                        $("#remark").val('');
                     }

                     $("#dialog_edit").dialog({
                        resizable: true,
                        width: 800,
                        modal: true,
                        buttons: {
                            "<?php echo __('EDIT_DIALOG_CALENDAR','highchart'); ?>": function() { 
                                $( this ).dialog( "close" ); 


                                $('#select_title option[value="'+event.title+'"]').prop('selected', true);
                                $("#edit_start_date").text($.fullCalendar.formatDate(event.start, "yyyy-MM-dd"));
                                if(event.end) {
                                    $("#edit_stop_date").text($.fullCalendar.formatDate(event.end, "yyyy-MM-dd"));
                                }else {
                                     $("#edit_stop_date").text($.fullCalendar.formatDate(event.start, "yyyy-MM-dd"));
                                }
                                if(event.description) {
                                     $("#select_remark").val(event.description);
                                } else {
                                    $("#select_remark").val('');
                                    $("#select_remark").text('');
                                }

                                if(event.color) {
                                   $("#select_color").val(event.color); 
                                   $('#colour').css({'background-color' : event.color});
                                }

                                $("#dialog_create").dialog({
                                resizable: true,
                                width: 800,
                                buttons: {
                                    "<?php echo __('SAVE_DIALOG_CALENDAR','highchart'); ?>": function() { 
                                        $( this ).dialog( "close" ); 
        
                                        new_start=$.fullCalendar.formatDate(event.start, "yyyy-MM-dd HH:mm:ss");
                                        if(!event.end) {
                                            new_end=$.fullCalendar.formatDate(event.start, "yyyy-MM-dd HH:mm:ss");        
                                        } else {
                                            new_end=$.fullCalendar.formatDate(event.end, "yyyy-MM-dd HH:mm:ss");        
                                        }

                                        var length = $('#select_title').children('option').length;
                                        if(($("#select_title").prop('selectedIndex')+1)==length) {
                                            if($("#other_field_title").val()!= "") {
                                                var title=$("#other_field_title").val();
                                            } else {
                                                var title=$('#select_title option:selected').val(); 
                                            }
                                        } else {
                                            var title=$('#select_title option:selected').val(); 
                                        }

                                        var color=$('#select_color').val();
                                        var description=$('#select_remark').val();
                                        if(!description) {
                                            description="";
                                        }
                                        if (title) {
                                            $('#calendar').fullCalendar('renderEvent', {
                                            title: title,
                                            start: new_start,
                                            end: new_end,
                                            description: description,
                                            color: color
                                        });

                                        if(!color) {
                                            color="#000000";
                                        }

                                       <?php if((isset($sd_card))&&(!empty($sd_card))) { ?>
                                            $.blockUI({ message: ''}); 
                                       <?php } ?>

                                        $.ajax({
                                            type: "POST",
                                            url: "http://localhost:6891/cultibox/main/modules/json-events/json-update-events.php",
                                            data: 'title='+encodeURIComponent(title)+'&start='+new_start+'&end='+new_end+'&desc='+encodeURIComponent(description)+'&id='+event.id+'&color='+color+'&card=<?php echo $sd_card; ?>'
                                            <?php if((isset($sd_card))&&(!empty($sd_card))) { ?>
                                                ,complete: function() { $.unblockUI(); }
                                            <?php } ?>
                                        }).done(function (data) {
                                            $.ajax({
                                                    type: "POST",
                                                    url: "http://localhost:6891/cultibox/main/modules/external/get_title_calendar_list.php",
                                                    data: 'lang='+encodeURIComponent("<?php echo $lang; ?>")
                                                }).done(function (data) {
                                                    if(data!="") {
                                                        var myTitle = data.split(',,,'); 
                                                        $('#select_title').children().remove();
                                                        $.each( myTitle, function( key, value ) {
                                                            $('#select_title').append(new Option(value, value, true, true)); 
                                                        });
                                                        $("#select_title").prop('selectedIndex', 0);  
                                                        $("#other_title_div").css("display","none");
                                                    }
                                                });
                                        });
                                        }
                                        event.title=title;
                                        event.description=description;
                                        event.color=color;
                                        $('#calendar').fullCalendar('removeEvents', event.id);
                                        $('#calendar').fullCalendar('updateEvent', event);
                                        $('#calendar').fullCalendar( 'refetchEvents' );
                                        $('#calendar').fullCalendar( 'rerenderEvents' );
                                        $("#select_remark").text("");
                                        $("#select_remark").val("");
                                        $("#other_field_title").text("");
                                        $("#other_field_title").val("");
                                        $("#select_title").prop('selectedIndex', 0);  
                                        delete event;
                                        <?php if((isset($sd_card))&&(!empty($sd_card))) { ?>
                                            $.blockUI({ message: '', timeout: 1000 }); 
                                        <?php } ?> 

                                        return false;
                                    },
                                    "<?php echo __('CANCEL_DIALOG_CALENDAR','highchart'); ?>": function() {     
                                        $( this ).dialog( "close" ); 
                                        delete event; 
                                        delete description; 
                                        $("#select_remark").text("");
                                        $("#select_remark").val(""); 
                                        $("#other_field_title").text("");
                                        $("#other_field_title").val("");
                                        $("#select_title").prop('selectedIndex', 0);
                                        return false;
                                    }
                            }
                            });
                        },
                            "<?php echo __('REMOVE_DIALOG_CALENDAR','highchart'); ?>": 
                            function() { 
                                        $( this ).dialog( "close" ); 
                                        <?php if((isset($sd_card))&&(!empty($sd_card))) { ?>
                                            $.blockUI({ message: ''}); 
                                        <?php } ?>
                                        $.ajax({
                                            type: "POST",
                                            url: "http://localhost:6891/cultibox/main/modules/json-events/json-remove-events.php",
                                            data: 'id='+event.id+'&card=<?php echo $sd_card; ?>'
                                            <?php if((isset($sd_card))&&(!empty($sd_card))) { ?>
                                                ,complete: function() { $.unblockUI(); }
                                            <?php } ?>
                                        }).done(function (data) {
                                            $.ajax({
                                                    type: "POST",
                                                    url: "http://localhost:6891/cultibox/main/modules/external/get_title_calendar_list.php",
                                                    data: 'lang='+encodeURIComponent("<?php echo $lang; ?>")
                                                }).done(function (data) {
                                                    if(data!="") {
                                                        var myTitle = data.split(',,,'); 
                                                        $('#select_title').children().remove();
                                                        $.each( myTitle, function( key, value ) {
                                                            $('#select_title').append(new Option(value, value, true, true)); 
                                                        });
                                                        $("#select_title").prop('selectedIndex', 0);  
                                                        $("#other_title_div").css("display","none");
                                                    }
                                                });
                                        });

                                        $('#calendar').fullCalendar('removeEvents', event.id);
                                        $('#calendar').fullCalendar( 'refetchEvents' );
                                        $('#calendar').fullCalendar( 'rerenderEvents' );
                                        <?php if((isset($sd_card))&&(!empty($sd_card))) { ?>
                                            $.blockUI({ message: '', timeout: 1000 }); 
                                        <?php } ?> 
                            },
                            "<?php echo __('CANCEL_DIALOG_CALENDAR','highchart'); ?>": function() { $( this ).dialog( "close" ); return false;}
                        }
                    });

                     if(event.external) {
                                    $(".ui-dialog-buttonpane button:contains('<?php echo __('EDIT_DIALOG_CALENDAR','highchart'); ?>')").attr("disabled", true).addClass("ui-state-disabled");
                                    $(".ui-dialog-buttonpane button:contains('<?php echo __('REMOVE_DIALOG_CALENDAR','highchart'); ?>')").attr("disabled", true).addClass("ui-state-disabled");
                     }

        },
            eventRender: function(event, eventElement) {
                var iconurl=null;
                
                if(event.icon) {
                   if(event.icon.search('http')>-1) {
                        iconurl=event.icon;
                    } else {
                        iconurl="http://localhost:6891/cultibox/main/modules/img/"+event.icon;
                    }

                    if (eventElement.find('span.fc-event-time').length) {
                        eventElement.find('span.fc-event-time').before("<img src='"+iconurl+"'  style='width:15px;height:15px'/>");
                    } else {
                        eventElement.find('span.fc-event-title').before("<img src='"+iconurl+"'  style='width:15px;height:15px'/>");
                    }
                }
            },

            loading: function(bool) {
                if (bool) $('#loading').show();
                else $('#loading').hide();
            }
            
        });
        
    });
</script>

<label class="title_conf"><?php echo __('CALENDAR_TITLE'); ?></label>
<table class="table_width">
    <tr>
        <td class="calendar_right"></td>
        <td><input id="datepicker_calendar" name="datepicker_calendar" type="hidden" value=""></td>
    </tr>
</table>

<div id='calendar'></div>

<div id="dialog_edit" title="<?php echo __('WHAT_DIALOG_CALENDAR'); ?>" style="display:none">
<table class="table_width">
<tr>
    <td><b><?php echo __('CALENDAR_SUBJECT'); ?>:</b></td>
    <td><span id="title"></span></td>
</tr>
<tr>
    <td><b><?php echo __('CALENDAR_START_DATE'); ?>:</b></td>
    <td><span id="start_date"></span></td>
</tr>
<tr>
    <td><b><?php echo __('CALENDAR_STOP_DATE'); ?>:</b></td>
    <td><span id="stop_date"></span></td>
</tr>
<tr>
    <td><b><?php echo __('CALENDAR_REMARK'); ?>:</b></td>
    <td><textarea rows="5" cols="50" id="remark" disabled></textarea></td>
</tr>
</table>
</div>


<div id="dialog_create" title="<?php echo __('MANAGE_CALENDAR'); ?>" style="display:none">
<form>
<table class="table_width">
<tr>
    <td><b><?php echo __('CALENDAR_SUBJECT'); ?>:</b></td>
    <td><table><tr><td><select id="select_title">
 <?php foreach($title_list as $value)  {
           echo "<option value=\"".$value."\">".$value."</option>";
       }
 ?> 
     </select></td><td><div id="other_title_div" style="display:none"><input name="other_field_title" id="other_field_title" type="text"></div></td></tr></table></td>
</tr>
<tr>
    <td><b><?php echo __('CALENDAR_START_DATE'); ?>:</b></td>
    <td><span id="edit_start_date"></span></td>
</tr>
<tr>
    <td><b><?php echo __('CALENDAR_STOP_DATE'); ?>:</b></td>
    <td><span id="edit_stop_date"></span></td>
</tr>
<tr>
    <td><b><?php echo __('CALENDAR_REMARK'); ?>:</b></td>
    <td><textarea rows="5" cols="60" id="select_remark"></textarea> 
</td>
</tr>
<tr>
    <td><b><?php echo __('CALENDAR_COLOR'); ?>:</b></td>
    <td><div id="jquery-colour-picker-example">
        <select id="colour" name="colour">
            <?php 
                for($i=0; $i<6; $i++) {
                    for($j=0; $j<6; $j++) {
                        for($k=0; $k<6; $k++) {
                            $c = $GLOBALS['LIST_GRAPHIC_COLOR_CALENDAR'][$i] .$GLOBALS['LIST_GRAPHIC_COLOR_CALENDAR'][$j] .$GLOBALS['LIST_GRAPHIC_COLOR_CALENDAR'][$k];
                            echo "<option value=\"$c\">#$c</option>\n";
                        }
                    }
                }
            ?>
        </select>
</div></td>
</tr>
</table>
<input type="hidden" id="select_color" value="">
</form>
</div>

<br />
<form action="calendar-<?php echo $_SESSION['SHORTLANG']; ?>" method="post" id="reset_calendar_form">
    <table class="table_width">
    <tr>
        <td class="calendar-marge"></td>
        <td><input type="submit" id="display_calendar" name="display_calendar" title="<?php echo __('TOOLTIP_MANAGE_XML'); ?>" <?php if(count($list_xml)==0) { ?>class="inputDisable" disabled value="<?php echo __('DISABLED_MANAGE_EXTERNAL_XML'); ?>" <?php } else { ?> value="<?php echo __('MANAGE_EXTERNAL_XML'); ?>" <?php } ?>></td>
        <td><input type="submit" id="reset_calendar" name="reset_calendar" class="delete" title="<?php echo __('TOOLTIP_RESET_CALENDAR'); ?>" value="<?php echo __('MANAGE_RESET_CALENDAR'); ?>">
        </td>
        <td class="calendar-marge"></td>
    </tr>
    </table>
</form>
<div id="reset_dialog_calendar" title="<?php echo __('CONFIRMATION'); ?>" style="display:none">
<p><?php echo __('RESET_CONFIRM_CALENDAR'); ?></p>
</div>

<div id="valid_reset_calendar" style="display:none">
<p><?php echo __('VALID_DELETE_CALENDAR'); ?></p>
</div>

<div id="manage_external_xml" style="display:none" title="<?php echo __('XML_DISPLAYED_FILE'); ?>">
    <form name="xml_config" id="xml_config" action="calendar-<?php echo $_SESSION['SHORTLANG']; ?>" method="post">

    <?php foreach($list_xml as $file) { ?>
        <?php echo $file['name']; ?>: <input type="checkbox" id="<?php echo $file['name']; ?>" name="xml_checkbox" <?php if(strcmp($file['value'],"1")==0) echo 'checked'; ?>><br />
    <?php } ?>
    </form>
</div>

<br /><br /><br /><br /><br />

<div id="valid_create_calendar" style="display:none">
<p><?php echo __('VALID_ADD_CALENDAR'); ?></p>
</div>

<div id="error_create_calendar" style="display:none">
<p><?php echo __('ERROR_ADD_CALENDAR_PROGRAM'); ?></p>
</div>

<label class="title_conf"><?php echo __('CALENDAR_ENGRAIS'); ?></label>
<form name="create_calendar_program" id="create_calendar_program" action="calendar-<?php echo $_SESSION['SHORTLANG']; ?>" method="post">
    <table class="table_width">
        <tr>
            <td class="calendar-marge"></td>
            <td class="calendar-title"><?php echo __('CALENDAR_SUBSTRAT'); ?>:<img src="main/libs/img/infos.png" alt="" title="<?php echo __('TOOLTIP_CALENDAR_SUBSTRAT'); ?>" /></td>
            <td class="calendar-field">
                <select name="substrat" id="substrat">
                    <?php if(count($substrat)>0) { ?>
                        <?php foreach($substrat as $sub) { ?>
                            <option value="<?php echo $sub; ?>"><?php echo $sub; ?></option>
                        <?php } ?>
                    <?php } else { ?>
                            <option value="" disabled><?php echo __('DISABLED_XML_FILE'); ?></option>
                    <?php } ?>
                </select>
            </td>
            <td></td>
        </tr>
        <tr>
            <td></td>
            <td><?php echo __('CALENDAR_PROGRAM'); ?>:<img src="main/libs/img/infos.png" alt="" title="<?php echo __('TOOLTIP_PROGRAM'); ?>" /></td>
            <td>
                <select name="product" id="product">
                   <?php if(count($product)>0) { ?>
                        <?php foreach($product as $prod) { ?>
                            <option value="<?php echo $prod['marque']." - ".$prod['periode']; ?>" <?php if(strcmp($prod['substrat'],$substrat[0])!=0) echo 'disabled'; ?>><?php echo $prod['marque']." - ".$prod['periode']." (".$prod['substrat'].")"; ?></option>
                        <?php } ?>
                    <?php } else { ?>
                            <option value="" disabled><?php echo __('DISABLED_XML_FILE'); ?></option>
                    <?php } ?>
                </select>
            </td>
            <td></td>
        </tr>
        <tr>
            <td></td>
            <td><?php echo __('CALENDAR_STARTDATE'); ?>:<img src="main/libs/img/infos.png" alt="" title="<?php echo __('TOOLTIP_CALENDAR_STARTDATE'); ?>" /></td>
            <td><input id="calendar_startdate" name="calendar_startdate" type="text" class="whitefield" size="10" value="<?php echo $calendar_start; ?>"></td>
            <td><div id="error_calendar_startdate" style="display:none" class="error_field"><img src='/cultibox/main/libs/img/arrow_error.png' alt=''><?php echo __('ERROR_FORMAT_CALENDAR_DATE'); ?></div></td>
        </tr>
        <tr>
            <td></td>
            <td><?php echo __('CALENDAR_EVENT_NAME'); ?>:<img src="main/libs/img/infos.png" alt="" title="<?php echo __('TOOLTIP_CALENDAR_EVENT_NAME'); ?>" /></td>
            <td><input id="event_name" name="event_name" type="text" class="whitefield" size="10" value=""></td>
            <td></td>
        </tr>
        <tr>
            <td></td>
            <td><?php echo __('CALENDAR_SELECT_CROISSANCE'); ?>:<img src="main/libs/img/infos.png" alt="" title="<?php echo __('TOOLTIP_CALENDAR_SELECT_CROISSANCE'); ?>" /></td>
            <td>
                <input type="radio" name="select_croissance" id="select_croissance" value="croi" checked="" /> <?php echo __('CALENDAR_CROISSANCE'); ?>
                <input type="radio" name="select_croissance" id="select_croissance" value="flo" checked="" /> <?php echo __('CALENDAR_FLORAISON'); ?>
                <input type="radio" name="select_croissance" id="select_croissance" value="all" checked="" /> <?php echo __('CALENDAR_CROISSANCE_+_FLORAISON'); ?>
            </td>
            <td></td>
        </tr>
    </table>
    <p class="p_center"><input type="submit" id="calendar-program" name="calendar-program" title="<?php echo __('TOOLTIP_CREATE_CALENDAR_PROGRAM'); ?>" <?php if((count($product)==0)||(count($substrat)==0)) { ?>class="inputDisable" disabled value="<?php echo __('DISABLED_CREATE_CALENDAR_PROGRAM'); ?>" <?php } else { ?> value="<?php echo __('CREATE_CALENDAR_PROGRAM'); ?>" <?php } ?>></p>
</form>




