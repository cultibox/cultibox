
<?php 
    // Include javascript functions
    include('main/libs/js/page_logs.js');
?>

<br />
<label class="title_conf"><?php echo __('SELECT_LOG_TITLE'); ?></label>

<!-- Display buttons -->
<table class="table_width">
    <tr>
        <td class="log-div-margin-param"></td>
        <td>
            <!-- Button to change parameters-->
            <input type="image" id="button_parameters" 
                name="button_parameters"
                title="<?php echo __('TOOLTIP_PARAMETERS_LOGS'); ?>"
                src="main/libs/img/advancedsettings.png"  width="34"
                alt="parameters"
            />
            <!-- Button to view curve to select-->
            <input type="image" id="curve_select_button"
                name="curve_select_button"
                title="<?php echo __('SELECT_CURVE_TO_DISPLAY'); ?>"
                src="main/libs/img/text-x-log.png"  width="40"
                alt="parameters"
            />
            <!-- Button to manage database-->
            <input type="image" id="database_management_button"
                name="database_management_button"
                title="<?php echo __('MANAGE_LOG_INFOS'); ?>"
                src="main/libs/img/database.png"  width="40"
                alt="parameters"
            />
    </tr>
</table>
<br />


<div id="label_select_type">
    <form name="display-log" id="display-log" action="display-logs-<?php echo $_SESSION['SHORTLANG']; ?>" method="post">
        <table class="table_width">
            <tr>
                <td class="log-marge-day-main"></td>
                <td><b><?php echo __('SELECT_DISPLAYED_DAY'); ?>:</b></td>
                <td>
                    <input type= "radio" id="select_day" name="type_select" value="day" <?php if($type == "day") echo "checked"; ?> onChange="getType(0);" onLoad="getType(0);" ><?php echo __('ONE_DAY'); ?>
                    <input type= "radio" id="select_month" name="type_select" value="month" <?php if($type == "month") echo "checked"; ?> onChange="getType(1);" onLoad="getType(1);" ><?php echo __('ONE_MONTH'); ?>
                </td>
                <td></td>
            </tr>
            
            <!-- One empty line -->
            <tr><td><br /></td><td></td><td></td><td></td></tr>
            <tr id="label_select_day" style="<?php if(strcmp($type,"day")!=0) echo "display:none"; ?>">
                <td></td>
                <td><?php echo __('SELECT_DAY'); ?>:</td>
                <td>
                    <input id="datepicker" name="startday" type="text" class="whitefield" size="10" value="<?php echo $startday; ?>">
                </td>
                <td>
                    <div id="error_start_days" style="display:none" class="error_field"><img src='/cultibox/main/libs/img/arrow_error.png' alt=''><?php echo __('ERROR_FORMAT_DATE_DAY'); ?></div>
                </td>
            </tr>
            <tr id="label_select_month" style="<?php if(strcmp($type,"day")==0) echo "display:none"; ?>">
                <td ></td>
                <td ><?php echo __('MONTH_DATE'); ?>:</td>
                <td >
                    <select name="startmonth" id="startmonth">
                       <option <?php if("$startmonth" == "1") { echo 'selected';} ?> value="01"><?php echo __('MONTH01'); ?></option>
                       <option <?php if("$startmonth" == "2") { echo 'selected';} ?> value="02"><?php echo __('MONTH02'); ?></option>
                       <option <?php if("$startmonth" == "3") { echo 'selected';} ?> value="03"><?php echo __('MONTH03'); ?></option>
                       <option <?php if("$startmonth" == "4") { echo 'selected';} ?> value="04"><?php echo __('MONTH04'); ?></option>
                       <option <?php if("$startmonth" == "5") { echo 'selected';} ?> value="05"><?php echo __('MONTH05'); ?></option>
                       <option <?php if("$startmonth" == "6") { echo 'selected';} ?> value="06"><?php echo __('MONTH06'); ?></option>
                       <option <?php if("$startmonth" == "7") { echo 'selected';} ?> value="07"><?php echo __('MONTH07'); ?></option>
                       <option <?php if("$startmonth" == "8") { echo 'selected';} ?> value="08"><?php echo __('MONTH08'); ?></option>
                       <option <?php if("$startmonth" == "9") { echo 'selected';} ?> value="09"><?php echo __('MONTH09'); ?></option>
                       <option <?php if("$startmonth" == "10") { echo 'selected';} ?> value="10"><?php echo __('MONTH10'); ?></option>
                       <option <?php if("$startmonth" == "11") { echo 'selected';} ?> value="11"><?php echo __('MONTH11'); ?></option>
                       <option <?php if("$startmonth" == "12") { echo 'selected';} ?> value="12"><?php echo __('MONTH12'); ?></option>
                    </select>

                    <?php 
                         echo '<select name="startyear" id="startyear">';
                         $first = $GLOBALS['FIRST_LOG_YEAR'];
                         for($i = $first ; $i <= date('Y'); $i++) { ?>
                             <option <?php if($startyear == $i) { echo 'selected';} ?> value="<?php echo $i; ?>"><?php echo $i; ?></option>
                          <?php }
                          echo "</select>";
                    ?>
                </td>
                <td>
                    <div id="error_start_month" class="error_field" style="display:none"><img src='/cultibox/main/libs/img/arrow_error.png' alt=''><?php echo __('ERROR_FORMAT_DATE_MONTH'); ?></div>
                </td> 
            </tr>
            
            <!-- One empty line -->
            <tr><td><br /></td><td></td><td></td><td></td></tr>
            <tr>
                <td></td>
                <td><?php echo __('SELECT_SENSOR_NB'); ?>:</td>
                <td>
                    <table id="select_logs_to_display" class="table_width">
                        <tr>
                            <?php 
                                $check_conf_sensor=false;

                                for($i = 1 ; $i <= $GLOBALS['NB_MAX_SENSOR_LOG'] ; $i++) {
                                    // Read sensor informations
                                    $sensorInfo = logs\get_sensor_db_type($i);

                                    if ($sensorInfo[0]['type'] != "0") {
                                        $check_conf_sensor=true;
                                        echo '<td>' . __('SENSOR'). " " . $i . ' (' . __($sensorInfo[0]['translation']) . ')</td>';
                                        echo '<td  style="margin-right:30px;" >';
                                        echo '<input type="checkbox"'
                                            . ' name="select_sensor[]"'
                                            . ' sensor="' . $i . '"' 
                                            . ' startDate="' . $legend_date . '"'
                                            . ' datatype = "logs"'
                                            . ' yAxis = ""'
                                            . ' serieID=""'
                                            . ' value="' . $i .'"' ;
                                            
                                        if(in_array($i,$select_sensor))
                                        { 
                                            echo ' checked'; 
                                        }
                                        echo '>';
                                        echo '</td>';
                                        echo '<td class="log-marge-day-main"></td>';

                                        // Add a line every two sensors
                                        if($i % 2 == 0) { 
                                            echo '</tr><tr>' ;
                                        }

                                    }
                                }

                                if(!$check_conf_sensor) {
                                        echo "<b>".__('NO_SENSOR_DEFINED').'</b><img src="main/libs/img/infos.png" alt="" title="'.__('TOOLTIP_NO_SENSOR_DEFINED').'" />';
                                }
                            ?>
                        </tr>
                    </table>
                </td>
            </tr>
        </table> 
        <br />

        <!-- Display button to display -->
        <table class="table_width">
            <tr>
                <td></td>
                <td class="program-valid-right">
                    <input type="submit" value=<?php echo __('VIEW'); ?> name="display-log-submit" id="display-log-submit" >
                </td>
                <td></td>
            </tr>
        </table>
        
        <input type="hidden" name="import_load" id="import_load" value="<?php echo $import_load; ?>">
        
    </form>
</div>
<br />
<hr />

<br />
<table class="table_width">
    <tr>
        <td class="left_log"></td>
        <td class="center_log"></td>
        <td class="right_log">
            <?php 
                if("$second_regul" == "True")
                { 
                    echo '<img id="regul_and_minmax_summary" src="main/libs/img/resume.png" alt="" title="';
                    if(!empty($resume_regul)) {
                        echo $resume_regul; 
                    }
                    echo '" />';
                } 
            ?>
        </td>
    </tr>
    <tr>
        <td class="left_log">
            <form action="display-logs-<?php echo $_SESSION['SHORTLANG']; ?>" method="post">
                <input type="submit" value="<" name="previous" class="button_log" title="<?php if(strcmp($type,"day")==0) echo __('PREVIOUS_BUTTON_DAY'); else echo __('PREVIOUS_BUTTON_MONTH'); ?>">
                <?php if($type == "day") { ?>
                    <input type="hidden" name="startday" value="<?php echo date('Y-m-d',strtotime("-1 day", strtotime("$startday"))); ?>">
                <?php } else {
                        if("$startmonth" == "01") {
                            $month="12"; 
                         } else {
                            $month=$startmonth-1;
                            if(strlen($month)<2) {
                                $month="0$month";
                            }
                        }
                    ?>
                    <input type="hidden" name="startmonth" value="<?php echo "$month"; ?>">
                    <input type="hidden" name="startyear" value="<?php if(strcmp("$startmonth","01")==0) echo $startyear-1; else echo $startyear; ?>">
                    <input type="hidden" name="type_select" value="month">
                <?php } ?>

                <input type="hidden" name="select_plug" value="<?php echo $select_plug; ?>">
            </form>
        </td>
        <td class="center_log"><div id="container" style="width: 850px; height: 425px; margin: 0 auto"></div></td>
        <td class="right_log">
            <?php 
                 $dd=date('d');    
                 $yy=date('Y');
                 $mm=date('m');
            ?>
            <form action="display-logs-<?php echo $_SESSION['SHORTLANG']; ?>" method="post">
                <input type="submit" value=">" name="next" class="button_log" title="<?php if(strcmp($type,"day")==0) echo __('NEXT_BUTTON_DAY'); else echo __('NEXT_BUTTON_MONTH'); ?>">
                <?php if(strcmp($type,"day")==0) { ?>
                    <input type="hidden" name="startday" value="<?php echo date('Y-m-d',strtotime("+1 day", strtotime("$startday"))); ?>">
                <?php } else { ?>
                    <?php 
                        if($startmonth == "12") {
                                $month="01"; 
                         } else {
                                $month=$startmonth+1;
                                if(strlen($month)<2) {
                                    $month="0$month";
                                }
                        }
                    ?>
                    <input type="hidden" name="startmonth" value="<?php echo "$month"; ?>">
                    <input type="hidden" name="startyear" value="<?php if(strcmp("$startmonth","12")==0) echo $startyear+1; else echo $startyear; ?>" >
                    <input type="hidden" name="type_select" value="month">
                <?php } ?>

                <input type="hidden" name="select_plug" value="<?php echo $select_plug; ?>">
            </form>
        </td>
    </tr>
</table>
<p class="p_center"><button id="resetXzoom" name="buttonX" style="display:none"><?php echo __('RESET_ZOOM_TITLE'); ?></button> <button id="resetzoom" name="button" style="display:none"><?php echo __('RESET_ZOOM_TITLE'); ?></button></p>
<p class="precision_infos">
<?php if(strcmp($type,"day")==0)  echo "*"." ".__('PRECISION_GRAPH_DAY'); else echo "*"." ".__('PRECISION_GRAPH_MONTH'); ?>
</p>



<div id="progress_load" title="<?php echo __('LOAD_LOG_PROGRESS'); ?>" style="display:none">
    <p><?php echo __('PROGRESS_LOG'); ?>:</p>
    <div id="progress_bar_load"></div>
    <p class="p_center">
        <label class="format_success" id="success_load" style="display:none"><?php echo __('VALID_LOAD_LOG'); ?></label>
        <label class="format_error" id="error_load" style="display:none"><?php echo __('ERROR_LOAD_LOG'); ?></label>
        <label class="format_success" id="success_load_auto" style="display:none"><?php echo __('VALID_AUTO_LOAD_LOG'); ?></label>
    </p>

    <br />
    <p><?php echo __('PROGRESS_POWER'); ?>:</p>

    <div id="progress_bar_load_power"></div>
    <p class="p_center">
        <label class="format_success" id="success_load_power" style="display:none"><?php echo __('VALID_LOAD_LOG'); ?></label>
        <label class="format_error" id="error_load_power" style="display:none"><?php echo __('ERROR_LOAD_LOG'); ?></label>
        <label class="format_success" id="success_load_power_auto" style="display:none"><?php echo __('VALID_AUTO_LOAD_LOG'); ?></label>
    </p>
    <br />
    <label class="format_success" id="success_load_still_log" style="display:none"><?php echo __('STILL_LOG_FILE'); ?></label>
</div>

<div id="delete_log_form" title="<?php echo __('MANAGE_RESET_TITLE'); ?>" style="display:none">
    <table class="table_width">
        <tr>
            <td class="delete_message_border"><b><?php echo __('DELETE_ALL_LOGS'); ?>:</b></td>
            <td><input id="check_delete_all" name="check_type_delete" type="radio" value="all" checked/></td>
        </tr>
    </table>
    <br />
    <table class="table_width">
        <tr>
            <td class="delete_message_border"><b><?php echo __('DELETE_SPECIFIC_LOGS'); ?>:</b></td>
            <td><input id="check_delete_specific" name="check_type_delete" type="radio" value="specific"/></td>
        </tr>
    </table>
    <div id="div_delete_specific" style="display:none">
    <br />
    <hr />
    <br />
    <table class="table_width">
        <tr>
            <td class="field_delete_form"><?php echo __('DELETE_LOGS_FROM'); ?>: <input id="datepicker_from" name="delete_startday" type="text" class="whitefield" size="10" value="<?php echo $startday; ?>"><?php echo __('DELETE_LOGS_TO'); ?>: <input id="datepicker_to" name="delete_endday" type="text" class="whitefield" size="10" value="<?php echo $startday; ?>"></td>
            <td></td>
        </tr>
    </table>
    </div>

    <br />
    <br />
    <p class="p_center">
        <label class="format_error" id="error_format_date_logs" style="display:none"><?php echo __('ERROR_FORMAT_DATE'); ?></label>
    </p>

    <div id="progress_delete_logs" style="display:none">
        <p><?php echo __('DELETE_PROGRESS'); ?>:</p>
        <div id="progress_bar_delete_logs"></div>
        <br />
        <p class="p_center">
            <label class="format_success" id="success_delete_logs" style="display:none"><?php echo __('VALID_DELETE_LOGS'); ?></label>
            <label class="format_error" id="error_delete_logs" style="display:none"><?php echo __('ERROR_DELETE_LOGS'); ?></label>
        </p>
    </div>
</div>


<div id="delete_log_form_power" title="<?php echo __('MANAGE_RESET_TITLE_POWER'); ?>" style="display:none">
    <table class="table_width">
        <tr>
            <td class="delete_message_border"><b><?php echo __('DELETE_ALL_LOGS'); ?>:</b></td>
            <td><input id="check_delete_all_power" name="check_type_delete_power" type="radio" value="all" checked/></td>
        </tr>
    </table>
    <br />
    <table class="table_width">
        <tr>
            <td class="delete_message_border"><b><?php echo __('DELETE_SPECIFIC_LOGS'); ?>:</b></td>
            <td><input id="check_delete_specific_power" name="check_type_delete_power" type="radio" value="specific"/></td>
        </tr>
    </table>
    <div id="div_delete_specific_power" style="display:none">
        <br />
        <hr />
        <br />
        <table class="table_width">
            <tr>
                <td class="field_delete_form"><?php echo __('DELETE_LOGS_FROM'); ?>: <input id="datepicker_from_power" name="delete_startday" type="text" class="whitefield" size="10" value="<?php echo $startday; ?>"><?php echo __('DELETE_LOGS_TO'); ?>: <input id="datepicker_to_power" name="delete_endday" type="text" class="whitefield" size="10" value="<?php echo $startday; ?>"></td>
                <td></td>
            </tr>
        </table>
    </div>

    <br />
    <br />

    <p class="p_center">
    <label class="format_error" id="error_format_date_logs_power" style="display:none"><?php echo __('ERROR_FORMAT_DATE'); ?></label>
    </p>

    <div id="progress_delete_logs_power" style="display:none">
        <p><?php echo __('DELETE_PROGRESS'); ?>:</p>
        <div id="progress_bar_delete_logs_power"></div>
        <br />
        <p class="p_center">
        <label class="format_success" id="success_delete_logs_power" style="display:none"><?php echo __('VALID_DELETE_LOGS'); ?></label>
        <label class="format_error" id="error_delete_logs_power" style="display:none"><?php echo __('ERROR_DELETE_LOGS'); ?></label>
        </p>
    </div>
</div>

<!-- Div used to dislay curve to show -->
<div id="select_curve" title="<?php echo __('PARAMETERS_CURVE_DISPLAYED') ?>" style="display:none">
    <!-- Programm curve selection -->
    <div id="select_program_curve">
        <p>
            <?php echo __('SELECT_PROGRAM_PLUG') ?> : 
            <img src="main/libs/img/infos.png" alt="" title="<?php echo __('TOOLTIP_LOG_PROGRAM'); ?>" />
        </p>
        <table id="select_plug_program_on_day" class="table_width">
                <tr>
            <?php 
                for($plugs=1;$plugs<=$nb_plugs;$plugs++) {
                    echo '<td class="log-div-margin-param"></td>';
                    $plugArrayTranslate =  translate_PlugType($plugs_infos[$plugs - 1]['PLUG_TYPE']);
                    echo '<td class="log-marge-day-title">' . __('PLUG_MENU') . " " . $plugs . " (" . $plugArrayTranslate . ")";
                    echo '<input type="checkbox" style="margin-right:30px;"'
                        . ' plug="' . $plugs . '"' 
                        . ' startDate="' . $legend_date . '"'
                        . ' name="select_program[]"'
                        . ' datatype = "program"'
                        . ' yAxis = ""'
                        . ' serieID=""'
                        . ' curvename="' . $plugs_infos[$plugs-1]["PLUG_NAME"] . '"'
                        . ' value="' . $plugs . '" ';
                    if(in_array($plugs,$select_program)) {
                        echo ' checked';
                    }
                    echo '> </td>';

                    if($plugs % 3 == 0) { 
                        echo '<td class="log-div-margin-param"></td></tr><tr>';
                    }
                } 

                $tmp_cnt=$nb_plugs % 3;
                for($i=0;$i<3-$tmp_cnt;$i++) { ?>
                    <td></td>
                <?php } ?>
            </tr>
        </table>
    </div>
    <br /><br />
    <!-- Power curve selection -->
    <div id="select_power_curve">
        <p>
            <?php echo __('SELECT_POWER_PLUG'); ?> : 
            <img src="main/libs/img/infos.png" alt="" title="<?php echo __('TOOLTIP_POWER_LOG'); ?>" />
        </p>
        <table id="select_power_on_day" class="table_width">
            <tr>
            <?php 
                for($plugs=1;$plugs<=$nb_plugs;$plugs++) {  
                    $plugArrayTranslate =  translate_PlugType($plugs_infos[$plugs - 1]['PLUG_TYPE']);
                    echo '<td>' . __('PLUG_MENU') . " " . $plugs . " (" . $plugArrayTranslate . ")";
                    echo '<input type="checkbox" style="margin-right:30px;"'
                        . ' plug="' . $plugs . '"' 
                        . ' startDate="' . $legend_date . '"'
                        . ' name="select_power[]"'
                        . ' datatype = "power"'
                        . ' yAxis = ""'
                        . ' serieID=""'
                        . ' value="' . $plugs . '"';
                    if(in_array($plugs,$select_power)) {
                        echo ' checked'; 
                    }
                    echo '> </td>';
                    
                    if($plugs % 3 == 0)
                    {
                        echo '</tr><tr>' ;
                    }
                }
            ?>
            </tr>
        </table>
    </div>
</div>

<!-- Div used for parameters -->
<div id="ui_parameters" name="ui_parameters" title="<?php echo __('PARAMETERS_LOGS_TITLE') ?>" style="display:none">
    <table class="table_width">
        <tr>
            <td>
                <?php echo __('CONFIGURE_TEMPERATURE'); ?>:
            </td>
            <td>
                <select name="color_temperature_graph" curveType="temperature" >
                <?php 
                    foreach($GLOBALS['LIST_GRAPHIC_COLOR'] as $value) {
                        $color_lang = "COLOR_" . strtoupper($value);
                        if($value == $color_temperature) {
                            echo "<option value=\"" . $value . "\" selected >" . __($color_lang) . "</option>";
                        } 
                        else
                        {
                            echo "<option value=\"" . $value . "\" >" . __($color_lang) . "</option>";
                        }
                    }
                ?>
                </select>
            </td>
        </tr>
        <tr>
            <td class="conf-marge-td">
                <?php echo __('CONFIGURE_HUMIDITY'); ?>:
            </td>
            <td>
                <select name="color_humidity_graph" curveType="humidity" >
                <?php 
                    foreach($GLOBALS['LIST_GRAPHIC_COLOR'] as $value) {
                        $color_lang = "COLOR_" . strtoupper($value);
                        if($value == $color_humidity) {
                            echo "<option value=\"" . $value . "\" selected >" . __($color_lang) . "</option>";
                        } 
                        else
                        {
                            echo "<option value=\"" . $value . "\" >" . __($color_lang) . "</option>";
                        }
                    }
                ?>
                </select>
            </td>
        </tr>
        <tr>
            <td>
                <?php echo __('CONFIGURE_WATER'); ?>:
            </td>
            <td>
                <select name="color_water_graph" curveType="water" >
                <?php 
                    foreach($GLOBALS['LIST_GRAPHIC_COLOR'] as $value) {
                        $color_lang = "COLOR_" . strtoupper($value);
                        if($value == $color_water) {
                            echo "<option value=\"" . $value . "\" selected >" . __($color_lang) . "</option>";
                        } 
                        else
                        {
                            echo "<option value=\"" . $value . "\" >" . __($color_lang) . "</option>";
                        }
                    }
                ?>
                </select>
            </td>
        </tr>
        <tr>
            <td>
                <?php echo __('CONFIGURE_LEVEL'); ?>:
            </td>
            <td>
                <select name="color_level_graph" curveType="level" >
                <?php 
                    foreach($GLOBALS['LIST_GRAPHIC_COLOR'] as $value) {
                        $color_lang = "COLOR_" . strtoupper($value);
                        if($value == $color_level) {
                            echo "<option value=\"" . $value . "\" selected >" . __($color_lang) . "</option>";
                        } 
                        else
                        {
                            echo "<option value=\"" . $value . "\" >" . __($color_lang) . "</option>";
                        }
                    }
                ?>
                </select>
            </td>
        </tr>
        <tr>
            <td>
                <?php echo __('CONFIGURE_PH'); ?>:
            </td>
            <td>
                <select name="color_ph_graph" curveType="ph" >
                <?php 
                    foreach($GLOBALS['LIST_GRAPHIC_COLOR'] as $value) {
                        $color_lang = "COLOR_" . strtoupper($value);
                        if($value == $color_ph) {
                            echo "<option value=\"" . $value . "\" selected >" . __($color_lang) . "</option>";
                        } 
                        else
                        {
                            echo "<option value=\"" . $value . "\" >" . __($color_lang) . "</option>";
                        }
                    }
                ?>
                </select>
            </td>
        </tr>
        <tr>
            <td>
                <?php echo __('CONFIGURE_EC'); ?>:
            </td>
            <td>
                <select name="color_ec_graph" curveType="ec" >
                <?php 
                    foreach($GLOBALS['LIST_GRAPHIC_COLOR'] as $value) {
                        $color_lang = "COLOR_" . strtoupper($value);
                        if($value == $color_ec) {
                            echo "<option value=\"" . $value . "\" selected >" . __($color_lang) . "</option>";
                        } 
                        else
                        {
                            echo "<option value=\"" . $value . "\" >" . __($color_lang) . "</option>";
                        }
                    }
                ?>
                </select>
            </td>
        </tr>
        <tr>
            <td>
                <?php echo __('CONFIGURE_OD'); ?>:
            </td>
            <td>
                <select name="color_od_graph" curveType="od" >
                <?php 
                    foreach($GLOBALS['LIST_GRAPHIC_COLOR'] as $value) {
                        $color_lang = "COLOR_" . strtoupper($value);
                        if($value == $color_od) {
                            echo "<option value=\"" . $value . "\" selected >" . __($color_lang) . "</option>";
                        } 
                        else
                        {
                            echo "<option value=\"" . $value . "\" >" . __($color_lang) . "</option>";
                        }
                    }
                ?>
                </select>
            </td>
        </tr>
        <tr>
            <td>
                <?php echo __('CONFIGURE_ORP'); ?>:
            </td>
            <td>
                <select name="color_orp_graph" curveType="orp" >
                <?php 
                    foreach($GLOBALS['LIST_GRAPHIC_COLOR'] as $value) {
                        $color_lang = "COLOR_" . strtoupper($value);
                        if($value == $color_orp) {
                            echo "<option value=\"" . $value . "\" selected >" . __($color_lang) . "</option>";
                        } 
                        else
                        {
                            echo "<option value=\"" . $value . "\" >" . __($color_lang) . "</option>";
                        }
                    }
                ?>
                </select>
            </td>
        </tr>
        <tr>
            <td>
                <?php echo __('CONFIGURE_POWER'); ?>:
            </td>
            <td>
                <select name="color_power_graph" curveType="power" >
                <?php 
                    foreach($GLOBALS['LIST_GRAPHIC_COLOR'] as $value) {
                        $color_lang = "COLOR_" . strtoupper($value);
                        if($value == $color_power) {
                            echo "<option value=\"" . $value . "\" selected >" . __($color_lang) . "</option>";
                        } 
                        else
                        {
                            echo "<option value=\"" . $value . "\" >" . __($color_lang) . "</option>";
                        }
                    }
                ?>
                </select>
            </td>
        </tr>
    </table>
</div>

<!-- Div used for database management -->
<div id="ui_db_management" name="ui_db_management" title="<?php echo __('MANAGE_LOG_INFOS') ?>" style="display:none">

    <!-- Reload logs -->
    <form action="<?php echo($_SERVER['PHP_SELF']); ?>" method="post">
        <table class="table_width">
            <tr>
                <td class="log-manage-marge"></td>
                <td class="log-manage-title"><?php echo __('IMPORT_LOG_TITLE')." "; ?>
                    <select name="log_search" id="log_search">
                        <?php 
                        foreach($GLOBALS['LOG_SEARCH'] as $value) {
                            if($value==$import_load) {
                                echo "<option value=\"${value}\" selected>${value}</option>";
                            } else {
                                echo "<option value=\"${value}\">${value}</option>";
                            }
                        } 
                        ?>
                    </select>
                    <?php echo __('IMPORT_LAST_MONTH'); ?><img src="main/libs/img/infos.png" alt="" title="<?php echo __('TOOLTIP_CONFIG_LOG_SEARCH'); ?>" />
                <td class="log-manage-field">
                    <input type="submit" id="import_log" name="import_log" <?php if((!isset($sd_card))||(empty($sd_card))) { echo "disabled"; ?> class="inputDisable" value="<?php echo __('NO_IMPORT_LOG'); ?>" <?php } else { ?>value="<?php echo __('IMPORT_LOG'); ?>" <?php } ?>>
                </td>
                <td></td>
            </tr>
        </table>
    </form>
    
    <!-- Reset logs -->
    <form action="display-logs-<?php echo $_SESSION['SHORTLANG']; ?>" method="post" id="reset_log_form">
        <table class="table_width">
            <tr>
                <td class="log-manage-marge"></td>
                <td class="log-manage-title"><?php echo __('MANAGE_RESET_TITLE'); ?><img src="main/libs/img/infos.png" alt="" title="<?php echo __('TOOLTIP_RESET_LOG'); ?>" /></td>
                <td class="log-manage-field"><input type="submit" id="reset_log_submit" name="reset_log_submit" <?php if(!$check_log) { echo 'disabled'; ?> class="inputDisable" value="<?php echo __('MANAGE_EXPORT_EMPTY_LOG_CSV'); ?>" <?php } else { ?>value="<?php echo __('MANAGE_RESET_LOG'); ?>" <?php } ?>></td>
                <td></td>
            </tr>
        </table>
    </form>

    <!-- Export CSV logs -->
    <form action="display-logs-<?php echo $_SESSION['SHORTLANG']; ?>" method="post" >
        <table class="table_width">
            <tr>
                <td class="log-manage-marge"></td>
                <td class="log-manage-title"><?php echo __('MANAGE_EXPORT_LOG_CSV'); ?><img src="main/libs/img/infos.png" alt="" title="<?php echo __('TOOLTIP_EXPORT_LOG_CSV'); ?>" /></td>
                <td class="log-manage-field">
                    <input type="submit" id="export_log" name="export_log" <?php if(!$check_log) { echo 'disabled'; ?> class="inputDisable" value="<?php echo __('MANAGE_EXPORT_EMPTY_LOG_CSV'); ?>" <?php } else { ?> value="<?php echo __('MANAGE_EXPORT_LOG_CSV_BUTTON'); ?>"<?php } ?>>
                </td>
                <td></td>
            </tr>
        </table>
        <input type="hidden" name="quick_load" value="True">
        <input type="hidden" name="select_plug" value="<?php echo $select_plug; ?>">
        <?php if($type == "month") { ?>
            <input type="hidden" name="startmonth" value="<?php echo $startmonth; ?>">
            <input type="hidden" name="startyear" value="<?php echo $startyear; ?>" >
        <?php } else { ?>
            <input type="hidden" name="startday" value="<?php echo $startday; ?>">
        <?php } ?>
    </form>

    <!-- Delete power logs -->
    <form action="display-logs-<?php echo $_SESSION['SHORTLANG']; ?>" method="post" id="reset_log_power_form">
        <table class="table_width">
            <tr>
                <td class="log-manage-marge"></td>
                <td class="log-manage-title"><?php echo __('MANAGE_RESET_TITLE_POWER'); ?><img src="main/libs/img/infos.png" alt="" title="<?php echo __('TOOLTIP_RESET_LOG'); ?>" /></td>
                <td class="log-manage-field"><input type="submit" id="reset_log_power_submit" name="reset_log_power_submit" <?php if(!$check_power) { echo 'disabled'; ?> class="inputDisable" value="<?php echo __('MANAGE_EXPORT_EMPTY_POWER_CSV'); ?>" <?php } else { ?> value="<?php echo __('MANAGE_RESET_POWER'); ?>" <?php } ?>></td>
                <td></td>
            </tr>
        </table>
    </form>

    <!-- Export power csv -->
    <form action="display-logs-<?php echo $_SESSION['SHORTLANG']; ?>" method="post" >
        <table class="table_width">
            <tr>
                <td class="log-manage-marge"></td>
                <td class="log-manage-title"><?php echo __('MANAGE_EXPORT_POWER_CSV'); ?><img src="main/libs/img/infos.png" alt="" title="<?php echo __('TOOLTIP_EXPORT_POWER_CSV'); ?>" /></td>
                <td class="log-manage-field">
                    <input type="submit" id="export_log_power" name="export_log_power"  <?php if(!$check_power) { echo 'disabled'; ?> class="inputDisable" value="<?php echo __('MANAGE_EXPORT_EMPTY_POWER_CSV'); ?>" <?php } else { ?>  value="<?php echo __('MANAGE_EXPORT_POWER_CSV_BUTTON'); ?>"<?php } ?>>
                </td>
                <td></td>
            </tr>
        </table>
        <input type="hidden" name="quick_load" value="True">
        <input type="hidden" name="select_plug" value="<?php echo $select_plug; ?>">
        <?php if($type == "month") { ?>
            <input type="hidden" name="startmonth" value="<?php echo $startmonth; ?>">
            <input type="hidden" name="startyear" value="<?php echo $startyear; ?>" >
        <?php } else { ?>
            <input type="hidden" name="startday" value="<?php echo $startday; ?>">
        <?php } ?>
    </form>

</div>
