<script>
   $("[title]").tooltip({ position: { my: "left+15 center", at: "right center" } });
</script>

<?php 
    cultipi\check_db();
?>

<br />
<table class="table_width">
    <tr>    
        <td class="conf-menu-marge"></td>
        <td class="center_menu" >
            <button id="div_synoptic_label" class="cultipi_menu_h1" onclick="expand('synoptic_ui'); return false;"><?php echo __('CULTIPI_SYNOPTIC'); ?></button>
        </td>
        <td class="center_menu" >
            <button id="div_network_label" class="cultipi_menu_h1" onclick="expand('network_conf_ui'); return false;"><?php echo __('CULTIPI_NETWORK_CONF'); ?></button>
        </td>
        <td class="center_menu" >
            <button id="div_admin_label" class="cultipi_menu_h1" onclick="expand('admin_ui'); return false;"><?php echo __('CULTIPI_ADMIN'); ?></button>
        </td>
       <td class="conf-menu-marge"></td>
    </tr>
</table> 
<br />
<hr />
<br />
<br />

<!-- Section synoptic -->
<div id="div_synoptic_ui" style="">
    <!-- Display buttons -->
    <table class="table_width">
        <tr>
            <td class="calendar-conf-marge"></td> 
            <td class="calendar-title">
                <!-- Button to add a element -->
                <input type="image" id="syno_add_element" name="syno_add_element"
                       title="<?php echo __('CULTIPI_SYNO_ADD_ELEMENT'); ?>"
                       src="main/libs/img/db_add.png"  width="34" 
                       alt="calendar"  
                />        
            </td>
            <td class="calendar_right">
                <input id="datepicker_calendar" name="datepicker_calendar" type="hidden" value="">
            </td>
            <td class="calendar-conf-marge"></td>
        </tr>
    </table>
    
    <p>
    <?php echo cultipi\getSensorValue("1"); ?>
    </p>

    <div id="set" style="min-height: 700px;" >
        
        <?php
            // Add every sensor
            $sensorList = cultipi\getSensorOfSynoptic();

            foreach ($sensorList as $index => $sensor) 
            {
                
                echo '<div id="syno_elem_' . $sensor["id"] . '" class="" style="position:absolute; top:' . $sensor["y"] . 'px ; left:' . $sensor["x"] . 'px ;width: 120px; height: 70px; background-color: rgba(0, 0, 0, 0.01);z-index:' . $sensor["z"] . '" >';
                echo '  <table>';
                echo '    <tr>';
                echo '      <td>Capteur ' . $sensor["indexElem"] . '</td>';
                echo '      <td>';
                echo '          <input type="image" id="syno_elemConfigur_' . $sensor["id"] . '" name="syno_elemConfigur_' . $sensor["id"] . '"';
                echo '                 title=""';
                echo '                 src="main/libs/img/advancedsettings.png"  width="18"';
                echo '                 alt="configure"';
                echo '                 class="syno_conf_elem_button"';
                echo '          />';
                echo '      </td>';
                echo '    </tr>';
                echo '    <tr>';
                echo '      <td colspan="2">NA°C NA%RH</td>';
                echo '    </tr>';
                echo '  </table>';
                echo '  <img id="syno_elemImage_' . $sensor["id"] . '" src="main/libs/img/' . $sensor["image"] . '" alt="capteur" style="width:' . $sensor["scale"] . 'px;cursor: move" class="rotate' . $sensor["rotation"] . '">';
                echo '</div>';
            }
            
            // Add plugs
            $plugList = cultipi\getPlugOfSynoptic();
            foreach ($plugList as $index => $plug) 
            {
                echo '<div id="syno_elem_' . $plug["id"] . '" class="" style="position:absolute; top:' . $plug["y"] . 'px ; left:' . $plug["x"] . 'px ;width: 120px; height: 70px; background-color: rgba(0, 0, 0, 0.01);z-index:' . $plug["z"] . '" >';
                echo '  <table>';
                echo '    <tr>';
                echo '      <td>Prise ' . $plug["indexElem"] . '</td>';
                echo '      <td>';
                echo '          <input type="image" id="syno_elemConfigur_' . $plug["id"] . '" name="syno_elemConfigur_' . $plug["id"] . '"';
                echo '                 title=""';
                echo '                 src="main/libs/img/advancedsettings.png"  width="18"';
                echo '                 alt="configure"';
                echo '                 class="syno_conf_elem_button"';
                echo '          />';
                echo '      </td>';
                echo '    </tr>';
                echo '    <tr>';
                echo '      <td colspan="2">NA</td>';
                echo '    </tr>';
                echo '  </table>';
                echo '  <img id="syno_elemImage_' . $plug["id"] . '" src="main/libs/img/' . $plug["image"] . '" alt="Prise" style="width:' . $plug["scale"] . 'px;cursor: move" class="rotate' . $plug["rotation"] . '">';
                echo '</div>';
            }
            
            // Add other items
            $otherList = cultipi\getOtherOfSynoptic();
            foreach ($otherList as $index => $other) 
            {
                echo '<div id="syno_elem_' . $other["id"] . '" class="" style="position:absolute; top:' . $other["y"] . 'px ; left:' . $other["x"] . 'px ;width: 120px; height: 70px; background-color: rgba(0, 0, 0, 0.01);z-index:' . $other["z"] . '" >';
                echo '  <table>';
                echo '    <tr>';
                echo '      <td>';
                echo '          <input type="image" id="syno_elemConfigur_' . $other["id"] . '" name="syno_elemConfigur_' . $other["id"] . '"';
                echo '                 title=""';
                echo '                 src="main/libs/img/advancedsettings.png"  width="18"';
                echo '                 alt="configure"';
                echo '                 class="syno_conf_elem_button"';
                echo '          />';
                echo '      </td>';
                echo '    </tr>';
                echo '    <tr>';
                echo '    </tr>';
                echo '  </table>';
                echo '  <img id="syno_elemImage_' . $other["id"] . '" src="main/libs/img/' . $other["image"] . '" alt="Prise" style="width:' . $other["scale"] . 'px;cursor: move" class="rotate' . $other["rotation"] . '">';
                echo '</div>';
            }
            
            
        ?>
    </div>
    
    <!-- Drag message box for add element-->
    <div id="syno_add_element_ui" style="display:none" title="<?php echo __('CULTIPI_SYNO_ADD_ELEMENT'); ?>">
        <?php
            
        ?>
    </div>

    <!-- Message box for configuring element-->
    <div id="syno_configure_element" style="display:none" title="<?php echo __('CULTIPI_SYNO_CONF'); ?>">
        <table>
            <tr>
                <td>Image</td>
            </tr>
            <tr>
                <td>Rotation</td>
                <td><input id="syno_configure_element_rotate_0" type="radio" name="syno_configure_element_rotate" value="0" /> 0° </td>
                <td><input id="syno_configure_element_rotate_90" type="radio" name="syno_configure_element_rotate" value="90" /> 90° </td>
                <td><input id="syno_configure_element_rotate_180" type="radio" name="syno_configure_element_rotate" value="180" /> 180° </td>
                <td><input id="syno_configure_element_rotate_270" type="radio" name="syno_configure_element_rotate" value="270" /> 270° </td>
            </tr>
            <tr>
                <td>Profondeur</td>
                <td><input type="text" name="syno_configure_element_zindex_val" id="syno_configure_element_zindex_val" value="" size="4" readonly /></td>
                <td colspan="3" ><div id="syno_configure_element_zindex"></div></td>
            </tr>
            <tr>
                <td>Zoom</td>
                <td><input type="text" name="syno_configure_element_scale_val" id="syno_configure_element_scale_val" value="" size="4" readonly /></td>
                <td colspan="3" ><div id="syno_configure_element_scale"></div></td>
            </tr>
        <?php
            
        ?>
        </table>
    </div>
    
</div>

<!-- Conf reseau -->
<div id="div_network_conf_ui" style="display:none">
<table class="table_width">
<tr>
    <td class="conf-marge-cultipi"></td>
    <td><?php echo __('CULTINET_LINK'); ?></td>
</tr>
</table>
</div>

<!-- Admin -->
<div id="div_admin_ui" style="display:none">
<p class="title_conf"><?php echo __('CULTIPI_LOGS'); ?></p>
<br />
<table class="table_width">
<tr>
    <td class="conf-marge-cultipi"></td>
    <td  class="conf-field-cultipi"><?php echo __('CULTIPI_LOGS_HTTPD'); ?>:</td>
    <td><button id="logs_httpd" name="cultipi_logs"><?php echo __('CULTIPI_VIEW_LOGS'); ?></button></td>
    <td></td>
    <td></td>
</tr>
<tr>
    <td></td>
    <td><?php echo __('CULTIPI_LOGS_MYSQL'); ?>:</td>
    <td><button id="logs_mysql" name="cultipi_logs"><?php echo __('CULTIPI_VIEW_LOGS'); ?></td>
    <td></td>
    <td></td>
</tr>
<tr>
    <td></td>
    <td><?php echo __('CULTIPI_LOGS_CULTIPI'); ?>:</td>
    <td><button id="logs_cultipi" name="cultipi_logs"><?php echo __('CULTIPI_VIEW_LOGS'); ?></td>
    <td></td>
    <td></td>
</tr>
</table>
<br />
<hr style="width:40%" />
<br />
<br />
<p class="title_conf"><?php echo __('CULTIPI_SOFT_VERSION'); ?></p>
<br />
<table class="table_width">
<tr>
    <td class="conf-marge-cultipi"></td>
    <td class="conf-field-cultipi"><?php echo __('CULTIPI_SOFT'); ?>:</td>
    <td><div id="div_cultipi_soft"></div></td>
    <td></td>
    <td></td>
</tr>
<tr>
    <td></td>
    <td><?php echo __('CULTINET_SOFT'); ?>:</td>
    <td><div id="div_cultinet_soft"></div></td>
    <td></td>
    <td></td>
</tr>
<tr>
    <td></td>
    <td><?php echo __('CULTIBOX_SOFT'); ?>:</td>
    <td><div id="div_cultibox_soft"></div></td>
    <td></td>
    <td></td>
</tr>
</table>

<br />
<hr style="width:40%"  />
<br />
<br />
<p class="title_conf"><?php echo __('SERVICE_MGT'); ?></p>
<br />
<table class="table_width">
<tr>
    <td class="conf-marge-cultipi"></td>
    <td class="conf-field-cultipi"><?php echo __('CULTIPI_SERVICE'); ?>:</td>
    <td class="conf-status-cultipi"><div id="cultipi_on" style="display:none"><img src='/cultibox/main/libs/img/service_on.png' alt='' title="<?php echo __('SERVICE_ON'); ?>"></div><div id="cultipi_off"><img src='/cultibox/main/libs/img/service_off.png' alt='' title="<?php echo __('SERVICE_OFF'); ?>"></div></td>
    <td><a href="" name="restart_service" id="restart_cultipi"><img src='/cultibox/main/libs/img/service_restart.png' alt='' title="<?php echo __('RESTART_SERVICE'); ?>" /></a></td>
    <td></td>
</tr>
</table>
</div>





<div id="dialog_logs_cultipi" style="display:none">
    <p class="p_center info_logs"><?php echo __('OUTPUT_LOGS'); ?>:</p>
    <div id="output_logs"></div>

    <p class="p_center error_logs"><?php echo __('ERROR_LOGS'); ?>:</p>
    <div id="error_logs"></div>
</div>


<div id="error_restart_service" title="" style="display:none">
    <p><?php echo __('ERROR_RESTART_SERVICE'); ?></p>
</div>

<div id="success_restart_service" title="" style="display:none">
    <p><?php echo __('SUCCESS_RESTART_SERVICE'); ?></p>
</div>

<script>expand("<?php echo $submenu; ?>");</script>
